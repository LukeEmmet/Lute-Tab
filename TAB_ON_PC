From daether@ra.ita.uni-heidelberg.de Wed Nov 24 08:06:30 1993
Received: from huey.dartmouth.edu by cs.dartmouth.edu (5.67/4.2)
	id AA11870; Wed, 24 Nov 93 08:06:29 -0500
Received: from ra.ita.uni-heidelberg.de by huey.dartmouth.edu (5.61a+YP/4.1)
	id AA23731; Wed, 24 Nov 93 08:05:05 -0500
Received: by ra.ita.uni-heidelberg.de id AA26842
  (5.65+/IDA-1.3.5 for wbc@huey.dartmouth.edu); Wed, 24 Nov 93 14:06:11 +0100
Date: Wed, 24 Nov 93 14:06:11 +0100
From: Michael Daether <daether@ra.ita.uni-heidelberg.de>
Message-Id: <9311241306.AA26842@ra.ita.uni-heidelberg.de>
To: wbc@cs.dartmouth.edu
Subject: tab
Status: OR

Wayne -

I tired to compile tab under OS/2 last night and ran into problems.
Following is a somewhat unsorted list of experiences,remarks and
problems I have, maybe you have an idea how to solve some.

- Some problems arise with the TPATH define. gcc complains about
  a invalid cast from integer to pointer in strcpy in subroutines
  open_tfm_file and open_pk_file; as a result the program dumps
  core. By direct inclusion of the path this was solved.
  On the other hand this hard coded path isn't too good at all;
  how about using an environment variable? (And maybe an extra
  hard coded path, if wanted)

- Problems arise from the different file system. DOS (and others I
  think) have the 8.3 character filenames, so every longer has to be  changed.
  You already changed the source file names, very good but the
  following remained:
  - temporary file name in ps.c[15]: tmpout="tbXXXXXX";
  - pk files in ps.c [50, ff]:  lute?.300pk -> lute?.300
  - PS_FONTS_? the names ot the tfm-files are too long

- Another problem is the different end-of-line characters (Unix uses
  LF, whilst DOS, OS/2, Atari and others use CR LF). Both compiling
  systems I used (under OS/2 and Atari) do by default a suitable
  I/O-transformation for text files, for unchanged binary transfer
  the file has to be opened with an extra 'b' attribute (i.e. 
  fopen(file,"rb") ). This binary mode has to be used for the dvi
  file and the tfm and pk files. (dvi.c[46], tfm.c[59,64], 
  pk_font.c[97,101])
  As another consequence of the text file transformations the number
  of read in characters does not agree with the file length (the
  former being the number of lines less), which gives error
  messages for every input file. This is of no further consequences,
  one could simply leave out this test.

- mkdepend does not work on non UNIX-Systems. Couldn't you include
  some default dependencies in the Makefile, so this is not a big
  problem?


- These were the problems I found workarounds; still the OS/2
  program core dumps when doing big Postscript output (dvi is fine).
  I suspect some stack problems, but I don't know how to handle
  gdb and how to change the stack and heap sizes.

- On the Atari, were I compiled Version 3.0e, some other problems
  also ocurred, which maybe are already fixed.
  - f->out_file is not initialized.
  - in dvi_prim.c an extra include file <ctype.h> had to be included
  - also in dvi_prim.c ps_top_of_page is needed even if no Postscr.
    is wanted.
  - The name getl ist already used by some system routine; changed 
    it to get_l. (main.c file.c get_sys.c)
  - I also have a note on strcpy here, probably the TFM_PATH problem
    I mentioned above.

- A general problem, discouvered in the allemand tab file (in music)
  The slanted lines seem to be wrong ending (and starting?). At
  least you specified a line by different starting and end points,
  and it appears horizontal in the output.

- Last point: The documentation is not up to date and sometimes
  even contradictory (e.g. full note w or W, half note w or h?).
  Why explain half in README and half in MANUAL? And INSTALL still
  talks about 'lute_tab.shar' and 'lute8.tar'! Maybe some other
  satisfied user is willing to volunteer here.

Finally I'd like to emphasize that I appreciate your program a lot;
please understand this points as ideas to make tab even better.


Michael

